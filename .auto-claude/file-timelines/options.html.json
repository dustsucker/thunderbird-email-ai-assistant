{
  "file_path": "options.html",
  "main_branch_history": [],
  "task_views": {
    "001-fix-provider-setup-with-dynamic-settings": {
      "task_id": "001-fix-provider-setup-with-dynamic-settings",
      "branch_point": {
        "commit_hash": "d2cdf71ba7ec64ddd1b6cc75a9afeb67bee49e7d",
        "content": "<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\" />\n    <title>Email Assistant</title>\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"options.css\" />\n  </head>\n  <body>\n    <div class=\"container\">\n      <h1>Mail Assistant Settings</h1>\n\n      <div class=\"tab-bar\">\n        <button class=\"tab-button active\" data-tab=\"general-settings\">General</button>\n        <button class=\"tab-button\" data-tab=\"custom-tags\">Custom Tags</button>\n      </div>\n\n      <!-- General Settings Tab -->\n      <div id=\"general-settings\" class=\"tab-content active\">\n        <form id=\"general-options-form\">\n          <div class=\"form-group\">\n            <label for=\"provider\">LLM Provider:</label>\n            <select id=\"provider\" name=\"provider\">\n              <option value=\"ollama\">Ollama</option>\n              <option value=\"mistral\">Mistral</option>\n              <option value=\"gemini\">Google Gemini</option>\n              <option value=\"deepseek\">DeepSeek</option>\n              <option value=\"openai\">OpenAI</option>\n              <option value=\"claude\">Anthropic Claude</option>\n              <option value=\"zai-paas\">Zai PaaS</option>\n              <option value=\"zai-coding\">Zai Coding</option>\n            </select>\n          </div>\n          <div id=\"ollama-settings\" class=\"provider-settings\">\n            <div class=\"form-group\">\n              <label for=\"ollama-api-url\">Ollama API URL:</label>\n              <input type=\"url\" id=\"ollama-api-url\" name=\"ollama-api-url\" />\n            </div>\n            <div class=\"form-group\">\n              <label for=\"ollama-model\">Ollama Model Name:</label>\n              <input type=\"text\" id=\"ollama-model\" name=\"ollama-model\" />\n              <p class=\"help-text\">\n                To add a new model, run <code>ollama pull &lt;model_name&gt;</code>.\n              </p>\n            </div>\n            <hr />\n            <div class=\"help-section\">\n              <h2>Ollama Setup</h2>\n              <p>\n                Ollama is a powerful tool that allows you to run open-source large language models\n                locally. You must first download and install the\n                <a href=\"https://ollama.com/\" target=\"_blank\">Ollama software</a> and host your own\n                instance.\n              </p>\n              <p>\n                <b>Privacy Benefit:</b> By using Ollama, all email analysis is performed on your own\n                computer. No data from your emails is ever sent to a third-party cloud service,\n                ensuring maximum privacy.\n              </p>\n              <p>\n                For the extension to connect, you must also configure Ollama to accept requests from\n                Thunderbird. Start your server with the <code>OLLAMA_ORIGINS</code> environment\n                variable set appropriately:\n              </p>\n              <pre><code>OLLAMA_ORIGINS='*' ollama serve</code></pre>\n            </div>\n          </div>\n\n          <!-- Mistral Settings -->\n          <div id=\"mistral-settings\" class=\"provider-settings\" style=\"display: none\">\n            <div class=\"form-group\">\n              <label for=\"mistral-api-key\">Mistral API Key:</label>\n              <input type=\"password\" id=\"mistral-api-key\" name=\"mistral-api-key\" />\n            </div>\n            <div class=\"help-section\">\n              <p>\n                <b>Privacy Notice:</b> By using Mistral, the content of your emails will be sent to\n                and processed by a third-party service (<a\n                  href=\"https://mistral.ai/\"\n                  target=\"_blank\"\n                  >Mistral AI</a\n                >). This includes potentially sensitive data\n              </p>\n              <p>\n                <b>GDPR Compliance:</b> Mistral is a company based in the EU, which may make it a\n                suitable choice for users concerned with GDPR compliance.\n              </p>\n            </div>\n          </div>\n\n          <!-- OpenAI Settings -->\n          <div id=\"openai-settings\" class=\"provider-settings\" style=\"display: none\">\n            <div class=\"form-group\">\n              <label for=\"openai-api-key\">OpenAI API Key:</label>\n              <input type=\"password\" id=\"openai-api-key\" name=\"openai-api-key\" />\n            </div>\n            <div class=\"help-section\">\n              <p>\n                <b>Privacy Notice:</b> By using OpenAI, the content of your emails will be sent to\n                and processed by a third-party service (<a href=\"https://openai.com\" target=\"_blank\"\n                  >OpenAI</a\n                >). This includes potentially sensitive data.\n              </p>\n            </div>\n          </div>\n\n          <!-- Gemini Settings -->\n          <div id=\"gemini-settings\" class=\"provider-settings\" style=\"display: none\">\n            <div class=\"form-group\">\n              <label for=\"gemini-api-key\">Google Gemini API Key:</label>\n              <input type=\"password\" id=\"gemini-api-key\" name=\"gemini-api-key\" />\n            </div>\n            <div class=\"help-section\">\n              <p>\n                <b>Privacy Notice:</b> By using Google Gemini, the content of your emails will be\n                sent to and processed by a third-party service (<a\n                  href=\"https://deepmind.google/technologies/gemini/\"\n                  target=\"_blank\"\n                  >Google</a\n                >). This includes potentially sensitive data.\n              </p>\n            </div>\n          </div>\n\n          <!-- Claude Settings -->\n          <div id=\"claude-settings\" class=\"provider-settings\" style=\"display: none\">\n            <div class=\"form-group\">\n              <label for=\"claude-api-key\">Anthropic Claude API Key:</label>\n              <input type=\"password\" id=\"claude-api-key\" name=\"claude-api-key\" />\n            </div>\n            <div class=\"help-section\">\n              <p>\n                <b>Privacy Notice:</b> By using Anthropic Claude, the content of your emails will be\n                sent to and processed by a third-party service (<a\n                  href=\"https://www.anthropic.com/\"\n                  target=\"_blank\"\n                  >Anthropic</a\n                >). This includes potentially sensitive data.\n              </p>\n            </div>\n          </div>\n\n          <!-- DeepSeek Settings -->\n          <div id=\"deepseek-settings\" class=\"provider-settings\" style=\"display: none\">\n            <div class=\"form-group\">\n              <label for=\"deepseek-api-key\">DeepSeek API Key:</label>\n              <input type=\"password\" id=\"deepseek-api-key\" name=\"deepseek-api-key\" />\n            </div>\n            <div class=\"help-section\">\n              <p>\n                <b>Privacy Notice:</b> By using DeepSeek, the content of your emails will be sent to\n                and processed by a third-party service (<a\n                  href=\"https://www.deepseek.com/\"\n                  target=\"_blank\"\n                  >DeepSeek</a\n                >). This includes potentially sensitive data.\n              </p>\n            </div>\n          </div>\n\n        <!-- Zai PaaS Settings -->\n        <div id=\"zai-paas-settings\" class=\"provider-settings\" style=\"display: none;\">\n          <h3>Zai PaaS Settings</h3>\n          <div class=\"form-group\">\n            <label for=\"zaiPaasApiKey\">API Key:</label>\n            <input type=\"password\" id=\"zaiPaasApiKey\" name=\"zaiPaasApiKey\">\n          </div>\n          <div class=\"form-group\">\n            <label for=\"zaiPaasModel\">Model:</label>\n            <select id=\"zaiPaasModel\" name=\"zaiPaasModel\"></select>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"zaiPaasBaseUrl\">Base URL (optional):</label>\n            <input type=\"text\" id=\"zaiPaasBaseUrl\" name=\"zaiPaasBaseUrl\">\n          </div>\n          <div class=\"help-section\">\n            <p><b>Privacy Notice:</b> By using Zai PaaS, the content of your emails will be sent to and processed by a third-party service (<a href=\"https://z.ai/\" target=\"_blank\">Zai</a>). This includes potentially sensitive data.</p>\n          </div>\n        </div>\n\n        <!-- Zai Coding Settings -->\n        <div id=\"zai-coding-settings\" class=\"provider-settings\" style=\"display: none;\">\n          <h3>Zai Coding Settings</h3>\n          <div class=\"form-group\">\n            <label for=\"zaiCodingApiKey\">API Key:</label>\n            <input type=\"password\" id=\"zaiCodingApiKey\" name=\"zaiCodingApiKey\">\n          </div>\n          <div class=\"form-group\">\n            <label for=\"zaiCodingModel\">Model:</label>\n            <select id=\"zaiCodingModel\" name=\"zaiCodingModel\"></select>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"zaiCodingBaseUrl\">Base URL (optional):</label>\n            <input type=\"text\" id=\"zaiCodingBaseUrl\" name=\"zaiCodingBaseUrl\">\n          </div>\n          <div class=\"help-section\">\n            <p><b>Privacy Notice:</b> By using Zai Coding, the content of your emails will be sent to and processed by a third-party service (<a href=\"https://z.ai/\" target=\"_blank\">Zai</a>). This includes potentially sensitive data.</p>\n          </div>\n        </div>\n            <div class=\"form-group\">\n              <label for=\"zai-model\">Model:</label>\n              <select id=\"zai-model\" name=\"zai-model\">\n                <!-- Wird dynamisch bef\u00fcllt -->\n              </select>\n            </div>\n            <div class=\"form-group\">\n              <label for=\"zai-variant\">Variant:</label>\n              <select id=\"zai-variant\" name=\"zai-variant\">\n                <option value=\"paas\">PaaS (Pay-per-use)</option>\n                <option value=\"coding\">Coding Plan (Subscription)</option>\n              </select>\n            </div>\n            <div class=\"help-section\">\n              <p>\n                <b>Privacy Notice:</b> By using z.ai, the content of your emails will be sent to and\n                processed by a third-party service (<a href=\"https://z.ai/\" target=\"_blank\">z.ai</a\n                >). This includes potentially sensitive data.\n              </p>\n            </div>\n          </div>\n\n          <div class=\"form-group\">\n            <button type=\"submit\">Save General Settings</button>\n            <span id=\"general-status-message\"></span>\n          </div>\n        </form>\n\n        <hr />\n\n        <div class=\"batch-analysis-container\">\n          <h2>Batch Email Analysis</h2>\n          <div class=\"form-group\">\n            <button type=\"button\" id=\"analyze-all-btn\" aria-label=\"Analyze all emails\">\n              Analysiere alle E-Mails\n            </button>\n            <button\n              type=\"button\"\n              id=\"cancel-analysis-btn\"\n              style=\"display: none\"\n              aria-label=\"Cancel analysis\"\n            >\n              Abbrechen\n            </button>\n            <button\n              type=\"button\"\n              id=\"kill-queue-btn\"\n              style=\"background-color: #dc3545; border-color: #dc3545; color: white\"\n              aria-label=\"Clear queue\"\n            >\n              Queue leeren\n            </button>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"analyze-progress\">Fortschritt:</label>\n            <progress id=\"analyze-progress\" value=\"0\" max=\"100\" style=\"display: none\"></progress>\n            <span id=\"analyze-progress-text\"></span>\n          </div>\n          <div class=\"form-group\">\n            <span id=\"analyze-status-message\" class=\"help-text\" aria-live=\"polite\"></span>\n          </div>\n        </div>\n\n        <hr />\n\n        <div class=\"cache-management-container\">\n          <h2>Cache Management</h2>\n          <p class=\"help-text\">\n            LLM-Antworten werden f\u00fcr 24 Stunden zwischengespeichert, um Token-Verbrauch zu\n            reduzieren.\n          </p>\n          <div class=\"form-group\">\n            <button\n              type=\"button\"\n              id=\"clear-cache-btn\"\n              style=\"background-color: #dc3545; border-color: #dc3545; color: white\"\n              aria-label=\"Clear cache\"\n            >\n              Cache leeren\n            </button>\n            <span id=\"cache-status-message\" class=\"help-text\"></span>\n          </div>\n          <div class=\"form-group\">\n            <span id=\"cache-stats\" class=\"help-text\"></span>\n          </div>\n        </div>\n      </div>\n\n      <!-- Custom Tags Tab -->\n      <div id=\"custom-tags\" class=\"tab-content\">\n        <p class=\"help-text\">\n          Define custom categories for email analysis. The key will be used in the prompt to the\n          LLM.\n        </p>\n        <div id=\"tag-list-container\"></div>\n        <button id=\"add-new-tag-btn\">Add New Tag</button>\n      </div>\n    </div>\n\n    <!-- Modal for Add/Edit Tag -->\n    <div id=\"tag-modal\" class=\"modal\" style=\"display: none\">\n      <div class=\"modal-content\">\n        <span class=\"close-button\">&times;</span>\n        <h2 id=\"modal-title\">Add New Tag</h2>\n        <form id=\"tag-form\">\n          <input type=\"hidden\" id=\"tag-index\" value=\"\" />\n          <div class=\"form-group\">\n            <label for=\"tag-name\">Tag Name:</label>\n            <input type=\"text\" id=\"tag-name\" required />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-key\">Tag Key:</label>\n            <input type=\"text\" id=\"tag-key\" required pattern=\"[a-z0-9_]+\" />\n            <p class=\"help-text\">Unique identifier (lowercase, numbers, underscores only).</p>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-color\">Tag Color:</label>\n            <input type=\"color\" id=\"tag-color\" value=\"#3498DB\" />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-prompt\">LLM Prompt Instruction:</label>\n            <textarea id=\"tag-prompt\" rows=\"3\" required></textarea>\n          </div>\n          <div class=\"form-group\">\n            <button type=\"submit\">Save Tag</button>\n          </div>\n        </form>\n      </div>\n    </div>\n\n    <script src=\"options-bundle.js\"></script>\n  </body>\n</html>\n",
        "timestamp": "2025-12-28T18:45:01.379116"
      },
      "worktree_state": {
        "content": "<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\" />\n    <title>Email Assistant</title>\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"options.css\" />\n  </head>\n  <body>\n    <div class=\"container\">\n      <h1>Mail Assistant Settings</h1>\n\n      <div class=\"tab-bar\">\n        <button class=\"tab-button active\" data-tab=\"general-settings\">General</button>\n        <button class=\"tab-button\" data-tab=\"custom-tags\">Custom Tags</button>\n      </div>\n\n      <!-- General Settings Tab -->\n      <div id=\"general-settings\" class=\"tab-content active\">\n        <form id=\"general-options-form\">\n          <div class=\"form-group\">\n            <label for=\"provider\">LLM Provider:</label>\n            <select id=\"provider\" name=\"provider\">\n              <option value=\"ollama\">Ollama</option>\n              <option value=\"mistral\">Mistral</option>\n              <option value=\"gemini\">Google Gemini</option>\n              <option value=\"deepseek\">DeepSeek</option>\n              <option value=\"openai\">OpenAI</option>\n              <option value=\"claude\">Anthropic Claude</option>\n              <option value=\"zai-paas\">Zai PaaS</option>\n              <option value=\"zai-coding\">Zai Coding</option>\n            </select>\n          </div>\n          <div id=\"ollama-settings\" class=\"provider-settings\">\n            <div class=\"form-group\">\n              <label for=\"ollama-api-url\">Ollama API URL:</label>\n              <input type=\"url\" id=\"ollama-api-url\" name=\"ollama-api-url\" />\n            </div>\n            <div class=\"form-group\">\n              <label for=\"ollama-model\">Ollama Model Name:</label>\n              <input type=\"text\" id=\"ollama-model\" name=\"ollama-model\" />\n              <p class=\"help-text\">\n                To add a new model, run <code>ollama pull &lt;model_name&gt;</code>.\n              </p>\n            </div>\n            <hr />\n            <div class=\"help-section\">\n              <h2>Ollama Setup</h2>\n              <p>\n                Ollama is a powerful tool that allows you to run open-source large language models\n                locally. You must first download and install the\n                <a href=\"https://ollama.com/\" target=\"_blank\">Ollama software</a> and host your own\n                instance.\n              </p>\n              <p>\n                <b>Privacy Benefit:</b> By using Ollama, all email analysis is performed on your own\n                computer. No data from your emails is ever sent to a third-party cloud service,\n                ensuring maximum privacy.\n              </p>\n              <p>\n                For the extension to connect, you must also configure Ollama to accept requests from\n                Thunderbird. Start your server with the <code>OLLAMA_ORIGINS</code> environment\n                variable set appropriately:\n              </p>\n              <pre><code>OLLAMA_ORIGINS='*' ollama serve</code></pre>\n            </div>\n          </div>\n\n          <!-- Mistral Settings -->\n          <div id=\"mistral-settings\" class=\"provider-settings\" style=\"display: none\">\n            <div class=\"form-group\">\n              <label for=\"mistral-api-key\">Mistral API Key:</label>\n              <input type=\"password\" id=\"mistral-api-key\" name=\"mistral-api-key\" />\n            </div>\n            <div class=\"help-section\">\n              <p>\n                <b>Privacy Notice:</b> By using Mistral, the content of your emails will be sent to\n                and processed by a third-party service (<a\n                  href=\"https://mistral.ai/\"\n                  target=\"_blank\"\n                  >Mistral AI</a\n                >). This includes potentially sensitive data\n              </p>\n              <p>\n                <b>GDPR Compliance:</b> Mistral is a company based in the EU, which may make it a\n                suitable choice for users concerned with GDPR compliance.\n              </p>\n            </div>\n          </div>\n\n          <!-- OpenAI Settings -->\n          <div id=\"openai-settings\" class=\"provider-settings\" style=\"display: none\">\n            <div class=\"form-group\">\n              <label for=\"openai-api-key\">OpenAI API Key:</label>\n              <input type=\"password\" id=\"openai-api-key\" name=\"openai-api-key\" />\n            </div>\n            <div class=\"help-section\">\n              <p>\n                <b>Privacy Notice:</b> By using OpenAI, the content of your emails will be sent to\n                and processed by a third-party service (<a href=\"https://openai.com\" target=\"_blank\"\n                  >OpenAI</a\n                >). This includes potentially sensitive data.\n              </p>\n            </div>\n          </div>\n\n          <!-- Gemini Settings -->\n          <div id=\"gemini-settings\" class=\"provider-settings\" style=\"display: none\">\n            <div class=\"form-group\">\n              <label for=\"gemini-api-key\">Google Gemini API Key:</label>\n              <input type=\"password\" id=\"gemini-api-key\" name=\"gemini-api-key\" />\n            </div>\n            <div class=\"help-section\">\n              <p>\n                <b>Privacy Notice:</b> By using Google Gemini, the content of your emails will be\n                sent to and processed by a third-party service (<a\n                  href=\"https://deepmind.google/technologies/gemini/\"\n                  target=\"_blank\"\n                  >Google</a\n                >). This includes potentially sensitive data.\n              </p>\n            </div>\n          </div>\n\n          <!-- Claude Settings -->\n          <div id=\"claude-settings\" class=\"provider-settings\" style=\"display: none\">\n            <div class=\"form-group\">\n              <label for=\"claude-api-key\">Anthropic Claude API Key:</label>\n              <input type=\"password\" id=\"claude-api-key\" name=\"claude-api-key\" />\n            </div>\n            <div class=\"help-section\">\n              <p>\n                <b>Privacy Notice:</b> By using Anthropic Claude, the content of your emails will be\n                sent to and processed by a third-party service (<a\n                  href=\"https://www.anthropic.com/\"\n                  target=\"_blank\"\n                  >Anthropic</a\n                >). This includes potentially sensitive data.\n              </p>\n            </div>\n          </div>\n\n          <!-- DeepSeek Settings -->\n          <div id=\"deepseek-settings\" class=\"provider-settings\" style=\"display: none\">\n            <div class=\"form-group\">\n              <label for=\"deepseek-api-key\">DeepSeek API Key:</label>\n              <input type=\"password\" id=\"deepseek-api-key\" name=\"deepseek-api-key\" />\n            </div>\n            <div class=\"help-section\">\n              <p>\n                <b>Privacy Notice:</b> By using DeepSeek, the content of your emails will be sent to\n                and processed by a third-party service (<a\n                  href=\"https://www.deepseek.com/\"\n                  target=\"_blank\"\n                  >DeepSeek</a\n                >). This includes potentially sensitive data.\n              </p>\n            </div>\n          </div>\n\n        <!-- Zai PaaS Settings -->\n        <div id=\"zai-paas-settings\" class=\"provider-settings\" style=\"display: none;\">\n          <h3>Zai PaaS Settings</h3>\n          <div class=\"form-group\">\n            <label for=\"zai-paas-api-key\">API Key:</label>\n            <input type=\"password\" id=\"zai-paas-api-key\" name=\"zai-paas-api-key\">\n          </div>\n          <div class=\"form-group\">\n            <label for=\"zai-paas-model\">Model:</label>\n            <select id=\"zai-paas-model\" name=\"zai-paas-model\"></select>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"zai-paas-base-url\">Base URL (optional):</label>\n            <input type=\"text\" id=\"zai-paas-base-url\" name=\"zai-paas-base-url\">\n          </div>\n          <div class=\"help-section\">\n            <p><b>Privacy Notice:</b> By using Zai PaaS, the content of your emails will be sent to and processed by a third-party service (<a href=\"https://z.ai/\" target=\"_blank\">Zai</a>). This includes potentially sensitive data.</p>\n          </div>\n        </div>\n\n        <!-- Zai Coding Settings -->\n        <div id=\"zai-coding-settings\" class=\"provider-settings\" style=\"display: none;\">\n          <h3>Zai Coding Settings</h3>\n          <div class=\"form-group\">\n            <label for=\"zai-coding-api-key\">API Key:</label>\n            <input type=\"password\" id=\"zai-coding-api-key\" name=\"zai-coding-api-key\">\n          </div>\n          <div class=\"form-group\">\n            <label for=\"zai-coding-model\">Model:</label>\n            <select id=\"zai-coding-model\" name=\"zai-coding-model\"></select>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"zai-coding-base-url\">Base URL (optional):</label>\n            <input type=\"text\" id=\"zai-coding-base-url\" name=\"zai-coding-base-url\">\n          </div>\n          <div class=\"help-section\">\n            <p><b>Privacy Notice:</b> By using Zai Coding, the content of your emails will be sent to and processed by a third-party service (<a href=\"https://z.ai/\" target=\"_blank\">Zai</a>). This includes potentially sensitive data.</p>\n          </div>\n        </div>\n\n          <div class=\"form-group\">\n            <button type=\"submit\">Save General Settings</button>\n            <span id=\"general-status-message\"></span>\n          </div>\n        </form>\n\n        <hr />\n\n        <div class=\"batch-analysis-container\">\n          <h2>Batch Email Analysis</h2>\n          <div class=\"form-group\">\n            <button type=\"button\" id=\"analyze-all-btn\" aria-label=\"Analyze all emails\">\n              Analysiere alle E-Mails\n            </button>\n            <button\n              type=\"button\"\n              id=\"cancel-analysis-btn\"\n              style=\"display: none\"\n              aria-label=\"Cancel analysis\"\n            >\n              Abbrechen\n            </button>\n            <button\n              type=\"button\"\n              id=\"kill-queue-btn\"\n              style=\"background-color: #dc3545; border-color: #dc3545; color: white\"\n              aria-label=\"Clear queue\"\n            >\n              Queue leeren\n            </button>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"analyze-progress\">Fortschritt:</label>\n            <progress id=\"analyze-progress\" value=\"0\" max=\"100\" style=\"display: none\"></progress>\n            <span id=\"analyze-progress-text\"></span>\n          </div>\n          <div class=\"form-group\">\n            <span id=\"analyze-status-message\" class=\"help-text\" aria-live=\"polite\"></span>\n          </div>\n        </div>\n\n        <hr />\n\n        <div class=\"cache-management-container\">\n          <h2>Cache Management</h2>\n          <p class=\"help-text\">\n            LLM-Antworten werden f\u00fcr 24 Stunden zwischengespeichert, um Token-Verbrauch zu\n            reduzieren.\n          </p>\n          <div class=\"form-group\">\n            <button\n              type=\"button\"\n              id=\"clear-cache-btn\"\n              style=\"background-color: #dc3545; border-color: #dc3545; color: white\"\n              aria-label=\"Clear cache\"\n            >\n              Cache leeren\n            </button>\n            <span id=\"cache-status-message\" class=\"help-text\"></span>\n          </div>\n          <div class=\"form-group\">\n            <span id=\"cache-stats\" class=\"help-text\"></span>\n          </div>\n        </div>\n      </div>\n\n      <!-- Custom Tags Tab -->\n      <div id=\"custom-tags\" class=\"tab-content\">\n        <p class=\"help-text\">\n          Define custom categories for email analysis. The key will be used in the prompt to the\n          LLM.\n        </p>\n        <div id=\"tag-list-container\"></div>\n        <button id=\"add-new-tag-btn\">Add New Tag</button>\n      </div>\n    </div>\n\n    <!-- Modal for Add/Edit Tag -->\n    <div id=\"tag-modal\" class=\"modal\" style=\"display: none\">\n      <div class=\"modal-content\">\n        <span class=\"close-button\">&times;</span>\n        <h2 id=\"modal-title\">Add New Tag</h2>\n        <form id=\"tag-form\">\n          <input type=\"hidden\" id=\"tag-index\" value=\"\" />\n          <div class=\"form-group\">\n            <label for=\"tag-name\">Tag Name:</label>\n            <input type=\"text\" id=\"tag-name\" required />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-key\">Tag Key:</label>\n            <input type=\"text\" id=\"tag-key\" required pattern=\"[a-z0-9_]+\" />\n            <p class=\"help-text\">Unique identifier (lowercase, numbers, underscores only).</p>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-color\">Tag Color:</label>\n            <input type=\"color\" id=\"tag-color\" value=\"#3498DB\" />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-prompt\">LLM Prompt Instruction:</label>\n            <textarea id=\"tag-prompt\" rows=\"3\" required></textarea>\n          </div>\n          <div class=\"form-group\">\n            <button type=\"submit\">Save Tag</button>\n          </div>\n        </form>\n      </div>\n    </div>\n\n    <script src=\"options-bundle.js\"></script>\n  </body>\n</html>\n",
        "last_modified": "2025-12-28T18:45:01.512211"
      },
      "task_intent": {
        "title": "001-fix-provider-setup-with-dynamic-settings",
        "description": "Fix broken provider settings UI by correcting HTML element ID mismatches between options.html and SettingsForm.ts, and removing orphan HTML elements that are outside provider settings divs. This ensures each provider's settings are correctly displayed and saved when the user selects that provider.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    },
    "003-confidence-score-display-and-threshold-configurati": {
      "task_id": "003-confidence-score-display-and-threshold-configurati",
      "branch_point": {
        "commit_hash": "f6a57e8f6ff34822855d2c5f711f425bd9bc6897",
        "content": "<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\" />\n    <title>Email Assistant</title>\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"options.css\" />\n  </head>\n  <body>\n    <div class=\"container\">\n      <header>\n        <h1>Mail Assistant Einstellungen</h1>\n      </header>\n\n      <div class=\"tab-bar\">\n        <button class=\"tab-button active\" data-tab=\"provider-settings\">Provider</button>\n        <button class=\"tab-button\" data-tab=\"custom-tags\">Benutzerdefinierte Tags</button>\n      </div>\n\n      <div id=\"provider-settings\" class=\"tab-content active\">\n        <section class=\"provider-section\">\n          <h2>Provider ausw\u00e4hlen</h2>\n          <div class=\"form-group\">\n            <label for=\"provider\">Provider:</label>\n            <select id=\"provider\" name=\"provider\">\n              <option value=\"ollama\">Ollama</option>\n              <option value=\"mistral\">Mistral</option>\n              <option value=\"gemini\">Gemini</option>\n              <option value=\"deepseek\">DeepSeek</option>\n              <option value=\"openai\">OpenAI</option>\n              <option value=\"claude\">Claude</option>\n              <option value=\"zai-paas\">Zai PaaS</option>\n              <option value=\"zai-coding\">Zai Coding</option>\n            </select>\n          </div>\n          <div class=\"provider-settings-container\">\n            <form id=\"provider-options-form\">\n              <div id=\"ollama-settings\" class=\"provider-settings active\">\n                <h3>Ollama-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"ollama-api-url\">Base URL:</label>\n                  <input\n                    type=\"url\"\n                    id=\"ollama-api-url\"\n                    name=\"ollama-api-url\"\n                    placeholder=\"http://localhost:11434\"\n                    pattern=\"https?://.+\"\n                    title=\"Bitte geben Sie eine g\u00fcltige URL ein (http:// oder https://)\"\n                    required\n                  />\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"ollama-model\">Model:</label>\n                  <input\n                    type=\"text\"\n                    id=\"ollama-model\"\n                    name=\"ollama-model\"\n                    placeholder=\"llama3.2\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice local-notice\">\n                  <p>\n                    <strong>Local Processing:</strong> Ollama runs entirely on your computer. Your\n                    emails never leave your device, ensuring maximum privacy.\n                  </p>\n                  <p>To add a new model, run <code>ollama pull &lt;model_name&gt;</code>.</p>\n                  <p>Start Ollama with: <code>OLLAMA_ORIGINS='*' ollama serve</code></p>\n                </div>\n              </div>\n\n              <div id=\"mistral-settings\" class=\"provider-settings\">\n                <h3>Mistral-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"mistral-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"mistral-api-key\"\n                    name=\"mistral-api-key\"\n                    placeholder=\"Geben Sie Ihren Mistral API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Privacy Notice:</strong> Emails are sent to Mistral AI (EU-based). GDPR\n                    compliant.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"gemini-settings\" class=\"provider-settings\">\n                <h3>Google Gemini-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"gemini-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"gemini-api-key\"\n                    name=\"gemini-api-key\"\n                    placeholder=\"Geben Sie Ihren Gemini API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an Google DeepMind zur\n                    Verarbeitung gesendet.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"deepseek-settings\" class=\"provider-settings\">\n                <h3>DeepSeek-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"deepseek-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"deepseek-api-key\"\n                    name=\"deepseek-api-key\"\n                    placeholder=\"Geben Sie Ihren DeepSeek API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an DeepSeek zur\n                    Verarbeitung gesendet.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"openai-settings\" class=\"provider-settings\">\n                <h3>OpenAI-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"openai-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"openai-api-key\"\n                    name=\"openai-api-key\"\n                    placeholder=\"Geben Sie Ihren OpenAI API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an OpenAI zur Verarbeitung\n                    gesendet.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"claude-settings\" class=\"provider-settings\">\n                <h3>Anthropic Claude-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"claude-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"claude-api-key\"\n                    name=\"claude-api-key\"\n                    placeholder=\"Geben Sie Ihren Claude API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an Anthropic Claude zur\n                    Verarbeitung gesendet.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"zai-paas-settings\" class=\"provider-settings\">\n                <h3>Zai PaaS-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"zaiPaasApiKey\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"zaiPaasApiKey\"\n                    name=\"zaiPaasApiKey\"\n                    placeholder=\"Geben Sie Ihren Zai PaaS API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"zaiPaasModel\">Model:</label>\n                  <select id=\"zaiPaasModel\" name=\"zaiPaasModel\" required></select>\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an Zai PaaS zur\n                    Verarbeitung gesendet. API-Schl\u00fcssel erforderlich.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"zai-coding-settings\" class=\"provider-settings\">\n                <h3>Zai Coding-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"zaiCodingApiKey\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"zaiCodingApiKey\"\n                    name=\"zaiCodingApiKey\"\n                    placeholder=\"Geben Sie Ihren Zai Coding API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"zaiCodingModel\">Model:</label>\n                  <select id=\"zaiCodingModel\" name=\"zaiCodingModel\" required></select>\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an Zai Coding zur\n                    Verarbeitung gesendet. API-Schl\u00fcssel erforderlich.\n                  </p>\n                </div>\n              </div>\n\n              <div class=\"form-group form-actions\">\n                <button type=\"submit\" class=\"btn-primary\">Provider-Einstellungen speichern</button>\n                <span id=\"provider-status-message\"></span>\n              </div>\n            </form>\n          </div>\n        </section>\n\n        <section class=\"system-management-section\">\n          <div class=\"system-cards-container\">\n            <div class=\"system-card emergency-card\">\n              <div class=\"card-header\">\n                <h3>Notfall-Stopp</h3>\n                <div class=\"card-icon emergency-icon\">\u26a0\ufe0f</div>\n              </div>\n              <p class=\"card-description\">Alle wartenden E-Mail-Analysen sofort stoppen.</p>\n              <button type=\"button\" id=\"kill-queue-btn\" class=\"btn-danger\">Queue leeren</button>\n              <span id=\"queue-status-message\" class=\"status-message\"></span>\n            </div>\n\n            <div class=\"system-card cache-card\">\n              <div class=\"card-header\">\n                <h3>Cache-Verwaltung</h3>\n                <div class=\"card-icon cache-icon\">\ud83d\uddc4\ufe0f</div>\n              </div>\n              <p class=\"card-description\">\n                LLM-Antworten werden 24 Stunden lang zwischengespeichert, um die Token-Nutzung zu\n                reduzieren.\n              </p>\n              <div class=\"cache-stats\" id=\"cache-stats\"></div>\n              <button type=\"button\" id=\"clear-cache-btn\" class=\"btn-secondary\">Cache leeren</button>\n              <span id=\"cache-status-message\" class=\"status-message\"></span>\n            </div>\n          </div>\n        </section>\n      </div>\n\n      <div id=\"custom-tags\" class=\"tab-content\">\n        <section class=\"custom-tags-section\">\n          <h2>Benutzerdefinierte Tags</h2>\n          <p class=\"help-text\">\n            Definieren Sie benutzerdefinierte Kategorien f\u00fcr die E-Mail-Analyse. Der Schl\u00fcssel wird\n            im Prompt f\u00fcr die LLM verwendet.\n          </p>\n          <div id=\"tag-list-container\"></div>\n          <button id=\"add-new-tag-btn\" class=\"btn-primary\">Neuen Tag hinzuf\u00fcgen</button>\n        </section>\n      </div>\n    </div>\n\n    <div id=\"tag-modal\" class=\"modal\" style=\"display: none\">\n      <div class=\"modal-content\">\n        <span class=\"close-button\">&times;</span>\n        <h2 id=\"modal-title\">Neuen Tag hinzuf\u00fcgen</h2>\n        <form id=\"tag-form\">\n          <input type=\"hidden\" id=\"tag-index\" value=\"\" />\n          <div class=\"form-group\">\n            <label for=\"tag-name\">Tag-Name:</label>\n            <input type=\"text\" id=\"tag-name\" required />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-key\">Tag-Schl\u00fcssel:</label>\n            <input type=\"text\" id=\"tag-key\" required pattern=\"[a-z0-9_]+\" />\n            <p class=\"help-text\">\n              Eindeutiger Bezeichner (nur Kleinbuchstaben, Zahlen, Unterstriche).\n            </p>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-color\">Tag-Farbe:</label>\n            <input type=\"color\" id=\"tag-color\" value=\"#3498DB\" />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-prompt\">LLM-Prompt-Anweisung:</label>\n            <textarea id=\"tag-prompt\" rows=\"3\" required></textarea>\n          </div>\n          <div class=\"form-group\">\n            <button type=\"submit\" class=\"btn-primary\">Tag speichern</button>\n          </div>\n        </form>\n      </div>\n    </div>\n\n    <!-- Error Display Overlay -->\n    <div id=\"error-display-overlay\" class=\"error-display-overlay\" style=\"display: none\">\n      <div class=\"error-display-content\">\n        <div class=\"error-display-header\">\n          <span class=\"error-display-icon\">\u26a0\ufe0f</span>\n          <h3 id=\"error-display-title\">Fehler aufgetreten</h3>\n          <button class=\"error-display-close\" aria-label=\"Fehlermeldung schlie\u00dfen\">&times;</button>\n        </div>\n        <p id=\"error-display-message\"></p>\n        <div id=\"error-display-details\"></div>\n      </div>\n    </div>\n\n    <script src=\"options-bundle.js\"></script>\n  </body>\n</html>\n",
        "timestamp": "2026-01-05T14:48:03.044500"
      },
      "worktree_state": {
        "content": "<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\" />\n    <title>Email Assistant</title>\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"options.css\" />\n  </head>\n  <body>\n    <div class=\"container\">\n      <header>\n        <h1>Mail Assistant Einstellungen</h1>\n      </header>\n\n      <div class=\"tab-bar\">\n        <button class=\"tab-button active\" data-tab=\"provider-settings\">Provider</button>\n        <button class=\"tab-button\" data-tab=\"analysis-settings\">Analyse-Einstellungen</button>\n        <button class=\"tab-button\" data-tab=\"custom-tags\">Benutzerdefinierte Tags</button>\n        <button class=\"tab-button\" data-tab=\"review-queue\">Review-Warteschlange</button>\n        <button class=\"tab-button\" data-tab=\"analysis-history\">Analyse-Historie</button>\n      </div>\n\n      <div id=\"provider-settings\" class=\"tab-content active\">\n        <section class=\"provider-section\">\n          <h2>Provider ausw\u00e4hlen</h2>\n          <div class=\"form-group\">\n            <label for=\"provider\">Provider:</label>\n            <select id=\"provider\" name=\"provider\">\n              <option value=\"ollama\">Ollama</option>\n              <option value=\"mistral\">Mistral</option>\n              <option value=\"gemini\">Gemini</option>\n              <option value=\"deepseek\">DeepSeek</option>\n              <option value=\"openai\">OpenAI</option>\n              <option value=\"claude\">Claude</option>\n              <option value=\"zai-paas\">Zai PaaS</option>\n              <option value=\"zai-coding\">Zai Coding</option>\n            </select>\n          </div>\n          <div class=\"provider-settings-container\">\n            <form id=\"provider-options-form\">\n              <div id=\"ollama-settings\" class=\"provider-settings active\">\n                <h3>Ollama-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"ollama-api-url\">Base URL:</label>\n                  <input\n                    type=\"url\"\n                    id=\"ollama-api-url\"\n                    name=\"ollama-api-url\"\n                    placeholder=\"http://localhost:11434\"\n                    pattern=\"https?://.+\"\n                    title=\"Bitte geben Sie eine g\u00fcltige URL ein (http:// oder https://)\"\n                    required\n                  />\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"ollama-model\">Model:</label>\n                  <input\n                    type=\"text\"\n                    id=\"ollama-model\"\n                    name=\"ollama-model\"\n                    placeholder=\"llama3.2\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice local-notice\">\n                  <p>\n                    <strong>Local Processing:</strong> Ollama runs entirely on your computer. Your\n                    emails never leave your device, ensuring maximum privacy.\n                  </p>\n                  <p>To add a new model, run <code>ollama pull &lt;model_name&gt;</code>.</p>\n                  <p>Start Ollama with: <code>OLLAMA_ORIGINS='*' ollama serve</code></p>\n                </div>\n              </div>\n\n              <div id=\"mistral-settings\" class=\"provider-settings\">\n                <h3>Mistral-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"mistral-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"mistral-api-key\"\n                    name=\"mistral-api-key\"\n                    placeholder=\"Geben Sie Ihren Mistral API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Privacy Notice:</strong> Emails are sent to Mistral AI (EU-based). GDPR\n                    compliant.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"gemini-settings\" class=\"provider-settings\">\n                <h3>Google Gemini-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"gemini-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"gemini-api-key\"\n                    name=\"gemini-api-key\"\n                    placeholder=\"Geben Sie Ihren Gemini API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an Google DeepMind zur\n                    Verarbeitung gesendet.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"deepseek-settings\" class=\"provider-settings\">\n                <h3>DeepSeek-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"deepseek-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"deepseek-api-key\"\n                    name=\"deepseek-api-key\"\n                    placeholder=\"Geben Sie Ihren DeepSeek API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an DeepSeek zur\n                    Verarbeitung gesendet.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"openai-settings\" class=\"provider-settings\">\n                <h3>OpenAI-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"openai-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"openai-api-key\"\n                    name=\"openai-api-key\"\n                    placeholder=\"Geben Sie Ihren OpenAI API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an OpenAI zur Verarbeitung\n                    gesendet.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"claude-settings\" class=\"provider-settings\">\n                <h3>Anthropic Claude-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"claude-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"claude-api-key\"\n                    name=\"claude-api-key\"\n                    placeholder=\"Geben Sie Ihren Claude API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an Anthropic Claude zur\n                    Verarbeitung gesendet.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"zai-paas-settings\" class=\"provider-settings\">\n                <h3>Zai PaaS-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"zaiPaasApiKey\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"zaiPaasApiKey\"\n                    name=\"zaiPaasApiKey\"\n                    placeholder=\"Geben Sie Ihren Zai PaaS API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"zaiPaasModel\">Model:</label>\n                  <select id=\"zaiPaasModel\" name=\"zaiPaasModel\" required></select>\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an Zai PaaS zur\n                    Verarbeitung gesendet. API-Schl\u00fcssel erforderlich.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"zai-coding-settings\" class=\"provider-settings\">\n                <h3>Zai Coding-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"zaiCodingApiKey\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"zaiCodingApiKey\"\n                    name=\"zaiCodingApiKey\"\n                    placeholder=\"Geben Sie Ihren Zai Coding API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"zaiCodingModel\">Model:</label>\n                  <select id=\"zaiCodingModel\" name=\"zaiCodingModel\" required></select>\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an Zai Coding zur\n                    Verarbeitung gesendet. API-Schl\u00fcssel erforderlich.\n                  </p>\n                </div>\n              </div>\n\n              <div class=\"form-group form-actions\">\n                <button type=\"submit\" class=\"btn-primary\">Provider-Einstellungen speichern</button>\n                <span id=\"provider-status-message\"></span>\n              </div>\n            </form>\n          </div>\n        </section>\n\n        <section class=\"system-management-section\">\n          <div class=\"system-cards-container\">\n            <div class=\"system-card emergency-card\">\n              <div class=\"card-header\">\n                <h3>Notfall-Stopp</h3>\n                <div class=\"card-icon emergency-icon\">\u26a0\ufe0f</div>\n              </div>\n              <p class=\"card-description\">Alle wartenden E-Mail-Analysen sofort stoppen.</p>\n              <button type=\"button\" id=\"kill-queue-btn\" class=\"btn-danger\">Queue leeren</button>\n              <span id=\"queue-status-message\" class=\"status-message\"></span>\n            </div>\n\n            <div class=\"system-card cache-card\">\n              <div class=\"card-header\">\n                <h3>Cache-Verwaltung</h3>\n                <div class=\"card-icon cache-icon\">\ud83d\uddc4\ufe0f</div>\n              </div>\n              <p class=\"card-description\">\n                LLM-Antworten werden 24 Stunden lang zwischengespeichert, um die Token-Nutzung zu\n                reduzieren.\n              </p>\n              <div class=\"cache-stats\" id=\"cache-stats\"></div>\n              <button type=\"button\" id=\"clear-cache-btn\" class=\"btn-secondary\">Cache leeren</button>\n              <span id=\"cache-status-message\" class=\"status-message\"></span>\n            </div>\n          </div>\n        </section>\n      </div>\n\n      <div id=\"analysis-settings\" class=\"tab-content\">\n        <section class=\"analysis-settings-section\">\n          <h2>Konfidenz-Schwellenwert</h2>\n          <p class=\"help-text\">\n            Legen Sie den minimalen Konfidenzwert fest, den ein Tag haben muss, um automatisch\n            angewendet zu werden. Tags mit niedrigerer Konfidenz werden zur manuellen \u00dcberpr\u00fcfung\n            markiert.\n          </p>\n\n          <div class=\"threshold-control-container\">\n            <div class=\"form-group\">\n              <label for=\"confidence-threshold-slider\">\n                Globaler Konfidenz-Schwellenwert: <span id=\"threshold-value\">70</span>%\n              </label>\n              <div class=\"slider-input-group\">\n                <input\n                  type=\"range\"\n                  id=\"confidence-threshold-slider\"\n                  class=\"threshold-slider\"\n                  min=\"0\"\n                  max=\"100\"\n                  value=\"70\"\n                  step=\"1\"\n                />\n                <input\n                  type=\"number\"\n                  id=\"confidence-threshold-input\"\n                  class=\"threshold-number-input\"\n                  min=\"0\"\n                  max=\"100\"\n                  value=\"70\"\n                  step=\"1\"\n                />\n              </div>\n              <p class=\"help-text\">\n                Empfohlener Wert: 70%. Niedrigere Werte f\u00fchren zu mehr automatisch angewendeten\n                Tags, aber auch zu mehr falsch positiven Klassifizierungen.\n              </p>\n            </div>\n\n            <div class=\"form-group form-actions\">\n              <button type=\"button\" id=\"save-threshold-btn\" class=\"btn-primary\">\n                Schwellenwert speichern\n              </button>\n              <button type=\"button\" id=\"reset-threshold-btn\" class=\"btn-secondary\">\n                Auf Standard zur\u00fccksetzen (70%)\n              </button>\n              <span id=\"threshold-status-message\" class=\"status-message\"></span>\n            </div>\n          </div>\n\n          <div class=\"threshold-info-section\">\n            <h3>Informationen zu Konfidenzwerten</h3>\n            <ul class=\"info-list\">\n              <li>\n                <strong>Hohe Konfidenz (>80%):</strong> Das KI-Modell ist sehr sicher, dass diese\n                Klassifizierung korrekt ist.\n              </li>\n              <li>\n                <strong>Mittlere Konfidenz (60-80%):</strong> Das KI-Modell ist recht sicher, aber\n                es gibt einige Unsicherheit.\n              </li>\n              <li>\n                <strong>Niedrige Konfidenz (<60%):</strong> Das KI-Modell ist unsicher. Eine\n                manliche \u00dcberpr\u00fcfung wird empfohlen.\n              </li>\n            </ul>\n          </div>\n        </section>\n      </div>\n\n      <div id=\"custom-tags\" class=\"tab-content\">\n        <section class=\"custom-tags-section\">\n          <h2>Benutzerdefinierte Tags</h2>\n          <p class=\"help-text\">\n            Definieren Sie benutzerdefinierte Kategorien f\u00fcr die E-Mail-Analyse. Der Schl\u00fcssel wird\n            im Prompt f\u00fcr die LLM verwendet.\n          </p>\n          <div id=\"tag-list-container\"></div>\n          <button id=\"add-new-tag-btn\" class=\"btn-primary\">Neuen Tag hinzuf\u00fcgen</button>\n        </section>\n      </div>\n\n      <div id=\"review-queue\" class=\"tab-content\">\n        <section class=\"review-queue-section\">\n          <h2>Review-Warteschlange</h2>\n          <p class=\"help-text\">\n            \u00dcberpr\u00fcfen Sie E-Mail-Klassifizierungen mit niedriger Konfidenz, bevor sie angewendet\n            werden.\n          </p>\n\n          <div class=\"review-stats-container\" id=\"review-stats-container\">\n            <div class=\"review-stat-card\">\n              <h3>Statistiken</h3>\n              <div id=\"review-stats\"></div>\n            </div>\n          </div>\n\n          <div class=\"review-filter-container\">\n            <div class=\"form-group\">\n              <label for=\"review-status-filter\">Status:</label>\n              <select id=\"review-status-filter\">\n                <option value=\"all\">Alle</option>\n                <option value=\"pending\" selected>Ausstehend</option>\n                <option value=\"approved\">Genehmigt</option>\n                <option value=\"rejected\">Abgelehnt</option>\n                <option value=\"ignored\">Ignoriert</option>\n              </select>\n            </div>\n\n            <div class=\"form-group\">\n              <label for=\"review-confidence-filter\">Minimale Konfidenz:</label>\n              <select id=\"review-confidence-filter\">\n                <option value=\"all\">Alle</option>\n                <option value=\"0-50\">Sehr niedrig (0-50%)</option>\n                <option value=\"50-60\">Niedrig (50-60%)</option>\n                <option value=\"60-70\">Mittel (60-70%)</option>\n                <option value=\"70-80\">Hoch (70-80%)</option>\n                <option value=\"80-100\">Sehr hoch (80-100%)</option>\n              </select>\n            </div>\n\n            <div class=\"form-group\">\n              <label for=\"review-sort-by\">Sortieren nach:</label>\n              <select id=\"review-sort-by\">\n                <option value=\"confidence-asc\">Konfidenz (niedrigste zuerst)</option>\n                <option value=\"confidence-desc\">Konfidenz (h\u00f6chste zuerst)</option>\n                <option value=\"date-desc\">Datum (neueste zuerst)</option>\n                <option value=\"date-asc\">Datum (\u00e4lteste zuerst)</option>\n              </select>\n            </div>\n\n            <div class=\"form-group\">\n              <button id=\"refresh-review-queue-btn\" class=\"btn-secondary\">Aktualisieren</button>\n              <button id=\"clear-reviewed-btn\" class=\"btn-secondary\">\u00dcberpr\u00fcfte entfernen</button>\n            </div>\n          </div>\n\n          <div id=\"review-queue-container\"></div>\n        </section>\n      </div>\n\n      <div id=\"analysis-history\" class=\"tab-content\">\n        <section class=\"analysis-history-section\">\n          <h2>Analyse-Historie</h2>\n          <p class=\"help-text\">\n            Verfolgen Sie Konfidenz-Trends und Statistiken Ihrer E-Mail-Analysen im Zeitverlauf.\n          </p>\n\n          <div class=\"history-filter-container\">\n            <div class=\"form-group\">\n              <label for=\"history-provider-filter\">Provider:</label>\n              <select id=\"history-provider-filter\">\n                <option value=\"all\">Alle Provider</option>\n              </select>\n            </div>\n\n            <div class=\"form-group\">\n              <label for=\"history-tag-filter\">Tag:</label>\n              <select id=\"history-tag-filter\">\n                <option value=\"all\">Alle Tags</option>\n              </select>\n            </div>\n\n            <div class=\"form-group\">\n              <label for=\"history-date-range-filter\">Zeitraum:</label>\n              <select id=\"history-date-range-filter\">\n                <option value=\"all\" selected>Alle Zeiten</option>\n                <option value=\"7d\">Letzte 7 Tage</option>\n                <option value=\"30d\">Letzte 30 Tage</option>\n                <option value=\"90d\">Letzte 90 Tage</option>\n                <option value=\"1y\">Letztes Jahr</option>\n              </select>\n            </div>\n\n            <div class=\"form-group\">\n              <button id=\"refresh-analysis-history-btn\" class=\"btn-secondary\">Aktualisieren</button>\n            </div>\n          </div>\n\n          <div id=\"analysis-history-stats\" class=\"history-stats-container\"></div>\n          <div id=\"analysis-history-container\" class=\"history-content\"></div>\n        </section>\n      </div>\n    </div>\n\n    <div id=\"tag-modal\" class=\"modal\" style=\"display: none\">\n      <div class=\"modal-content\">\n        <span class=\"close-button\">&times;</span>\n        <h2 id=\"modal-title\">Neuen Tag hinzuf\u00fcgen</h2>\n        <form id=\"tag-form\">\n          <input type=\"hidden\" id=\"tag-index\" value=\"\" />\n          <div class=\"form-group\">\n            <label for=\"tag-name\">Tag-Name:</label>\n            <input type=\"text\" id=\"tag-name\" required />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-key\">Tag-Schl\u00fcssel:</label>\n            <input type=\"text\" id=\"tag-key\" required pattern=\"[a-z0-9_]+\" />\n            <p class=\"help-text\">\n              Eindeutiger Bezeichner (nur Kleinbuchstaben, Zahlen, Unterstriche).\n            </p>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-color\">Tag-Farbe:</label>\n            <input type=\"color\" id=\"tag-color\" value=\"#3498DB\" />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-prompt\">LLM-Prompt-Anweisung:</label>\n            <textarea id=\"tag-prompt\" rows=\"3\" required></textarea>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-threshold\">Konfidenz-Schwellenwert (optional):</label>\n            <div class=\"slider-input-group\">\n              <input\n                type=\"range\"\n                id=\"tag-threshold-slider\"\n                class=\"threshold-slider\"\n                min=\"0\"\n                max=\"100\"\n                value=\"\"\n                step=\"1\"\n              />\n              <input\n                type=\"number\"\n                id=\"tag-threshold\"\n                class=\"threshold-number-input\"\n                min=\"0\"\n                max=\"100\"\n                value=\"\"\n                placeholder=\"Global\"\n                step=\"1\"\n              />\n            </div>\n            <p class=\"help-text\">\n              Leer lassen, um den globalen Schwellenwert zu verwenden. Ein benutzerdefinierter\n              Wert \u00fcberschreibt den globalen Schwellenwert f\u00fcr diesen Tag.\n            </p>\n          </div>\n          <div class=\"form-group\">\n            <button type=\"submit\" class=\"btn-primary\">Tag speichern</button>\n          </div>\n        </form>\n      </div>\n    </div>\n\n    <!-- Error Display Overlay -->\n    <div id=\"error-display-overlay\" class=\"error-display-overlay\" style=\"display: none\">\n      <div class=\"error-display-content\">\n        <div class=\"error-display-header\">\n          <span class=\"error-display-icon\">\u26a0\ufe0f</span>\n          <h3 id=\"error-display-title\">Fehler aufgetreten</h3>\n          <button class=\"error-display-close\" aria-label=\"Fehlermeldung schlie\u00dfen\">&times;</button>\n        </div>\n        <p id=\"error-display-message\"></p>\n        <div id=\"error-display-details\"></div>\n      </div>\n    </div>\n\n    <script src=\"options-bundle.js\"></script>\n  </body>\n</html>\n",
        "last_modified": "2026-01-05T19:59:00.203593"
      },
      "task_intent": {
        "title": "Confidence Score Display and Threshold Configuration",
        "description": "",
        "from_plan": false
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    },
    "010-confidence-score-display-and-threshold-configurati": {
      "task_id": "010-confidence-score-display-and-threshold-configurati",
      "branch_point": {
        "commit_hash": "bdfad3eb512d2cde785819b3e597f39d954633f3",
        "content": "<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\" />\n    <title>Email Assistant</title>\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"options.css\" />\n  </head>\n  <body>\n    <div class=\"container\">\n      <header>\n        <h1>Mail Assistant Einstellungen</h1>\n      </header>\n\n      <div class=\"tab-bar\">\n        <button class=\"tab-button active\" data-tab=\"provider-settings\">Provider</button>\n        <button class=\"tab-button\" data-tab=\"custom-tags\">Benutzerdefinierte Tags</button>\n      </div>\n\n      <div id=\"provider-settings\" class=\"tab-content active\">\n        <section class=\"provider-section\">\n          <h2>Provider ausw\u00e4hlen</h2>\n          <div class=\"form-group\">\n            <label for=\"provider\">Provider:</label>\n            <select id=\"provider\" name=\"provider\">\n              <option value=\"ollama\">Ollama</option>\n              <option value=\"mistral\">Mistral</option>\n              <option value=\"gemini\">Gemini</option>\n              <option value=\"deepseek\">DeepSeek</option>\n              <option value=\"openai\">OpenAI</option>\n              <option value=\"claude\">Claude</option>\n              <option value=\"zai-paas\">Zai PaaS</option>\n              <option value=\"zai-coding\">Zai Coding</option>\n            </select>\n          </div>\n          <div class=\"provider-settings-container\">\n            <form id=\"provider-options-form\">\n              <div id=\"ollama-settings\" class=\"provider-settings active\">\n                <h3>Ollama-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"ollama-api-url\">Base URL:</label>\n                  <input\n                    type=\"url\"\n                    id=\"ollama-api-url\"\n                    name=\"ollama-api-url\"\n                    placeholder=\"http://localhost:11434\"\n                    pattern=\"https?://.+\"\n                    title=\"Bitte geben Sie eine g\u00fcltige URL ein (http:// oder https://)\"\n                    required\n                  />\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"ollama-model\">Model:</label>\n                  <input\n                    type=\"text\"\n                    id=\"ollama-model\"\n                    name=\"ollama-model\"\n                    placeholder=\"llama3.2\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice local-notice\">\n                  <p>\n                    <strong>Local Processing:</strong> Ollama runs entirely on your computer. Your\n                    emails never leave your device, ensuring maximum privacy.\n                  </p>\n                  <p>To add a new model, run <code>ollama pull &lt;model_name&gt;</code>.</p>\n                  <p>Start Ollama with: <code>OLLAMA_ORIGINS='*' ollama serve</code></p>\n                </div>\n              </div>\n\n              <div id=\"mistral-settings\" class=\"provider-settings\">\n                <h3>Mistral-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"mistral-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"mistral-api-key\"\n                    name=\"mistral-api-key\"\n                    placeholder=\"Geben Sie Ihren Mistral API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Privacy Notice:</strong> Emails are sent to Mistral AI (EU-based). GDPR\n                    compliant.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"gemini-settings\" class=\"provider-settings\">\n                <h3>Google Gemini-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"gemini-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"gemini-api-key\"\n                    name=\"gemini-api-key\"\n                    placeholder=\"Geben Sie Ihren Gemini API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an Google DeepMind zur\n                    Verarbeitung gesendet.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"deepseek-settings\" class=\"provider-settings\">\n                <h3>DeepSeek-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"deepseek-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"deepseek-api-key\"\n                    name=\"deepseek-api-key\"\n                    placeholder=\"Geben Sie Ihren DeepSeek API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an DeepSeek zur\n                    Verarbeitung gesendet.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"openai-settings\" class=\"provider-settings\">\n                <h3>OpenAI-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"openai-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"openai-api-key\"\n                    name=\"openai-api-key\"\n                    placeholder=\"Geben Sie Ihren OpenAI API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an OpenAI zur Verarbeitung\n                    gesendet.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"claude-settings\" class=\"provider-settings\">\n                <h3>Anthropic Claude-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"claude-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"claude-api-key\"\n                    name=\"claude-api-key\"\n                    placeholder=\"Geben Sie Ihren Claude API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an Anthropic Claude zur\n                    Verarbeitung gesendet.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"zai-paas-settings\" class=\"provider-settings\">\n                <h3>Zai PaaS-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"zaiPaasApiKey\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"zaiPaasApiKey\"\n                    name=\"zaiPaasApiKey\"\n                    placeholder=\"Geben Sie Ihren Zai PaaS API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"zaiPaasModel\">Model:</label>\n                  <select id=\"zaiPaasModel\" name=\"zaiPaasModel\" required></select>\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an Zai PaaS zur\n                    Verarbeitung gesendet. API-Schl\u00fcssel erforderlich.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"zai-coding-settings\" class=\"provider-settings\">\n                <h3>Zai Coding-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"zaiCodingApiKey\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"zaiCodingApiKey\"\n                    name=\"zaiCodingApiKey\"\n                    placeholder=\"Geben Sie Ihren Zai Coding API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"zaiCodingModel\">Model:</label>\n                  <select id=\"zaiCodingModel\" name=\"zaiCodingModel\" required></select>\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an Zai Coding zur\n                    Verarbeitung gesendet. API-Schl\u00fcssel erforderlich.\n                  </p>\n                </div>\n              </div>\n\n              <div class=\"form-group form-actions\">\n                <button type=\"submit\" class=\"btn-primary\">Provider-Einstellungen speichern</button>\n                <span id=\"provider-status-message\"></span>\n              </div>\n            </form>\n          </div>\n        </section>\n\n        <section class=\"system-management-section\">\n          <div class=\"system-cards-container\">\n            <div class=\"system-card emergency-card\">\n              <div class=\"card-header\">\n                <h3>Notfall-Stopp</h3>\n                <div class=\"card-icon emergency-icon\">\u26a0\ufe0f</div>\n              </div>\n              <p class=\"card-description\">Alle wartenden E-Mail-Analysen sofort stoppen.</p>\n              <button type=\"button\" id=\"kill-queue-btn\" class=\"btn-danger\">Queue leeren</button>\n              <span id=\"queue-status-message\" class=\"status-message\"></span>\n            </div>\n\n            <div class=\"system-card cache-card\">\n              <div class=\"card-header\">\n                <h3>Cache-Verwaltung</h3>\n                <div class=\"card-icon cache-icon\">\ud83d\uddc4\ufe0f</div>\n              </div>\n              <p class=\"card-description\">\n                LLM-Antworten werden 24 Stunden lang zwischengespeichert, um die Token-Nutzung zu\n                reduzieren.\n              </p>\n              <div class=\"cache-stats\" id=\"cache-stats\"></div>\n              <button type=\"button\" id=\"clear-cache-btn\" class=\"btn-secondary\">Cache leeren</button>\n              <span id=\"cache-status-message\" class=\"status-message\"></span>\n            </div>\n          </div>\n        </section>\n      </div>\n\n      <div id=\"custom-tags\" class=\"tab-content\">\n        <section class=\"custom-tags-section\">\n          <h2>Benutzerdefinierte Tags</h2>\n          <p class=\"help-text\">\n            Definieren Sie benutzerdefinierte Kategorien f\u00fcr die E-Mail-Analyse. Der Schl\u00fcssel wird\n            im Prompt f\u00fcr die LLM verwendet.\n          </p>\n          <div id=\"tag-list-container\"></div>\n          <button id=\"add-new-tag-btn\" class=\"btn-primary\">Neuen Tag hinzuf\u00fcgen</button>\n        </section>\n      </div>\n    </div>\n\n    <div id=\"tag-modal\" class=\"modal\" style=\"display: none\">\n      <div class=\"modal-content\">\n        <span class=\"close-button\">&times;</span>\n        <h2 id=\"modal-title\">Neuen Tag hinzuf\u00fcgen</h2>\n        <form id=\"tag-form\">\n          <input type=\"hidden\" id=\"tag-index\" value=\"\" />\n          <div class=\"form-group\">\n            <label for=\"tag-name\">Tag-Name:</label>\n            <input type=\"text\" id=\"tag-name\" required />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-key\">Tag-Schl\u00fcssel:</label>\n            <input type=\"text\" id=\"tag-key\" required pattern=\"[a-z0-9_]+\" />\n            <p class=\"help-text\">\n              Eindeutiger Bezeichner (nur Kleinbuchstaben, Zahlen, Unterstriche).\n            </p>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-color\">Tag-Farbe:</label>\n            <input type=\"color\" id=\"tag-color\" value=\"#3498DB\" />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-prompt\">LLM-Prompt-Anweisung:</label>\n            <textarea id=\"tag-prompt\" rows=\"3\" required></textarea>\n          </div>\n          <div class=\"form-group\">\n            <button type=\"submit\" class=\"btn-primary\">Tag speichern</button>\n          </div>\n        </form>\n      </div>\n    </div>\n\n    <!-- Error Display Overlay -->\n    <div id=\"error-display-overlay\" class=\"error-display-overlay\" style=\"display: none\">\n      <div class=\"error-display-content\">\n        <div class=\"error-display-header\">\n          <span class=\"error-display-icon\">\u26a0\ufe0f</span>\n          <h3 id=\"error-display-title\">Fehler aufgetreten</h3>\n          <button class=\"error-display-close\" aria-label=\"Fehlermeldung schlie\u00dfen\">&times;</button>\n        </div>\n        <p id=\"error-display-message\"></p>\n        <div id=\"error-display-details\"></div>\n      </div>\n    </div>\n\n    <script src=\"options-bundle.js\"></script>\n  </body>\n</html>\n",
        "timestamp": "2026-01-06T07:24:51.082736"
      },
      "worktree_state": {
        "content": "<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\" />\n    <title>Email Assistant</title>\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"options.css\" />\n  </head>\n  <body>\n    <div class=\"container\">\n      <header>\n        <h1>Mail Assistant Einstellungen</h1>\n      </header>\n\n      <div class=\"tab-bar\">\n        <button class=\"tab-button active\" data-tab=\"provider-settings\">Provider</button>\n        <button class=\"tab-button\" data-tab=\"custom-tags\">Benutzerdefinierte Tags</button>\n        <button class=\"tab-button\" data-tab=\"analysis-results\">Analyseergebnisse</button>\n        <button class=\"tab-button\" data-tab=\"manual-review\">Manuelle \u00dcberpr\u00fcfung</button>\n      </div>\n\n      <div id=\"provider-settings\" class=\"tab-content active\">\n        <section class=\"provider-section\">\n          <h2>Provider ausw\u00e4hlen</h2>\n          <div class=\"form-group\">\n            <label for=\"provider\">Provider:</label>\n            <select id=\"provider\" name=\"provider\">\n              <option value=\"ollama\">Ollama</option>\n              <option value=\"mistral\">Mistral</option>\n              <option value=\"gemini\">Gemini</option>\n              <option value=\"deepseek\">DeepSeek</option>\n              <option value=\"openai\">OpenAI</option>\n              <option value=\"claude\">Claude</option>\n              <option value=\"zai-paas\">Zai PaaS</option>\n              <option value=\"zai-coding\">Zai Coding</option>\n            </select>\n          </div>\n\n          <div class=\"form-group\">\n            <label for=\"min-confidence-threshold\">\n              Minimales Konfidenz-Level: <span id=\"confidence-value\">70</span>%\n            </label>\n            <div style=\"display: flex; align-items: center; gap: 10px;\">\n              <input\n                type=\"range\"\n                id=\"min-confidence-threshold-slider\"\n                name=\"min-confidence-threshold-slider\"\n                min=\"0\"\n                max=\"100\"\n                value=\"70\"\n                style=\"flex: 1;\"\n              />\n              <input\n                type=\"number\"\n                id=\"min-confidence-threshold\"\n                name=\"min-confidence-threshold\"\n                min=\"0\"\n                max=\"100\"\n                value=\"70\"\n                style=\"width: 70px;\"\n              />\n            </div>\n            <p class=\"help-text\">\n              Tags werden nur angewendet, wenn das Konfidenz-Level dieses Wert erreicht oder \u00fcberschreitet.\n              Ein h\u00f6herer Wert bedeutet mehr Sicherheit, aber weniger automatisch angewendete Tags.\n            </p>\n          </div>\n\n          <div class=\"provider-settings-container\">\n            <form id=\"provider-options-form\">\n              <div id=\"ollama-settings\" class=\"provider-settings active\">\n                <h3>Ollama-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"ollama-api-url\">Base URL:</label>\n                  <input\n                    type=\"url\"\n                    id=\"ollama-api-url\"\n                    name=\"ollama-api-url\"\n                    placeholder=\"http://localhost:11434\"\n                    pattern=\"https?://.+\"\n                    title=\"Bitte geben Sie eine g\u00fcltige URL ein (http:// oder https://)\"\n                    required\n                  />\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"ollama-model\">Model:</label>\n                  <input\n                    type=\"text\"\n                    id=\"ollama-model\"\n                    name=\"ollama-model\"\n                    placeholder=\"llama3.2\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice local-notice\">\n                  <p>\n                    <strong>Local Processing:</strong> Ollama runs entirely on your computer. Your\n                    emails never leave your device, ensuring maximum privacy.\n                  </p>\n                  <p>To add a new model, run <code>ollama pull &lt;model_name&gt;</code>.</p>\n                  <p>Start Ollama with: <code>OLLAMA_ORIGINS='*' ollama serve</code></p>\n                </div>\n              </div>\n\n              <div id=\"mistral-settings\" class=\"provider-settings\">\n                <h3>Mistral-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"mistral-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"mistral-api-key\"\n                    name=\"mistral-api-key\"\n                    placeholder=\"Geben Sie Ihren Mistral API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Privacy Notice:</strong> Emails are sent to Mistral AI (EU-based). GDPR\n                    compliant.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"gemini-settings\" class=\"provider-settings\">\n                <h3>Google Gemini-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"gemini-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"gemini-api-key\"\n                    name=\"gemini-api-key\"\n                    placeholder=\"Geben Sie Ihren Gemini API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an Google DeepMind zur\n                    Verarbeitung gesendet.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"deepseek-settings\" class=\"provider-settings\">\n                <h3>DeepSeek-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"deepseek-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"deepseek-api-key\"\n                    name=\"deepseek-api-key\"\n                    placeholder=\"Geben Sie Ihren DeepSeek API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an DeepSeek zur\n                    Verarbeitung gesendet.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"openai-settings\" class=\"provider-settings\">\n                <h3>OpenAI-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"openai-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"openai-api-key\"\n                    name=\"openai-api-key\"\n                    placeholder=\"Geben Sie Ihren OpenAI API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an OpenAI zur Verarbeitung\n                    gesendet.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"claude-settings\" class=\"provider-settings\">\n                <h3>Anthropic Claude-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"claude-api-key\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"claude-api-key\"\n                    name=\"claude-api-key\"\n                    placeholder=\"Geben Sie Ihren Claude API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an Anthropic Claude zur\n                    Verarbeitung gesendet.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"zai-paas-settings\" class=\"provider-settings\">\n                <h3>Zai PaaS-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"zaiPaasApiKey\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"zaiPaasApiKey\"\n                    name=\"zaiPaasApiKey\"\n                    placeholder=\"Geben Sie Ihren Zai PaaS API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"zaiPaasModel\">Model:</label>\n                  <select id=\"zaiPaasModel\" name=\"zaiPaasModel\" required></select>\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an Zai PaaS zur\n                    Verarbeitung gesendet. API-Schl\u00fcssel erforderlich.\n                  </p>\n                </div>\n              </div>\n\n              <div id=\"zai-coding-settings\" class=\"provider-settings\">\n                <h3>Zai Coding-Konfiguration</h3>\n                <div class=\"form-group\">\n                  <label for=\"zaiCodingApiKey\">API Key:</label>\n                  <input\n                    type=\"password\"\n                    id=\"zaiCodingApiKey\"\n                    name=\"zaiCodingApiKey\"\n                    placeholder=\"Geben Sie Ihren Zai Coding API-Schl\u00fcssel ein\"\n                    pattern=\".{10,}\"\n                    title=\"API-Schl\u00fcssel muss mindestens 10 Zeichen lang sein\"\n                    required\n                  />\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"zaiCodingModel\">Model:</label>\n                  <select id=\"zaiCodingModel\" name=\"zaiCodingModel\" required></select>\n                </div>\n                <div class=\"privacy-notice\">\n                  <p>\n                    <strong>Datenschutz-Hinweis:</strong> E-Mails werden an Zai Coding zur\n                    Verarbeitung gesendet. API-Schl\u00fcssel erforderlich.\n                  </p>\n                </div>\n              </div>\n\n              <div class=\"form-group form-actions\">\n                <button type=\"submit\" class=\"btn-primary\">Provider-Einstellungen speichern</button>\n                <span id=\"provider-status-message\"></span>\n              </div>\n            </form>\n          </div>\n        </section>\n\n        <section class=\"system-management-section\">\n          <div class=\"system-cards-container\">\n            <div class=\"system-card emergency-card\">\n              <div class=\"card-header\">\n                <h3>Notfall-Stopp</h3>\n                <div class=\"card-icon emergency-icon\">\u26a0\ufe0f</div>\n              </div>\n              <p class=\"card-description\">Alle wartenden E-Mail-Analysen sofort stoppen.</p>\n              <button type=\"button\" id=\"kill-queue-btn\" class=\"btn-danger\">Queue leeren</button>\n              <span id=\"queue-status-message\" class=\"status-message\"></span>\n            </div>\n\n            <div class=\"system-card cache-card\">\n              <div class=\"card-header\">\n                <h3>Cache-Verwaltung</h3>\n                <div class=\"card-icon cache-icon\">\ud83d\uddc4\ufe0f</div>\n              </div>\n              <p class=\"card-description\">\n                LLM-Antworten werden 24 Stunden lang zwischengespeichert, um die Token-Nutzung zu\n                reduzieren.\n              </p>\n              <div class=\"cache-stats\" id=\"cache-stats\"></div>\n              <button type=\"button\" id=\"clear-cache-btn\" class=\"btn-secondary\">Cache leeren</button>\n              <span id=\"cache-status-message\" class=\"status-message\"></span>\n            </div>\n          </div>\n        </section>\n      </div>\n\n      <div id=\"custom-tags\" class=\"tab-content\">\n        <section class=\"custom-tags-section\">\n          <h2>Benutzerdefinierte Tags</h2>\n          <p class=\"help-text\">\n            Definieren Sie benutzerdefinierte Kategorien f\u00fcr die E-Mail-Analyse. Der Schl\u00fcssel wird\n            im Prompt f\u00fcr die LLM verwendet.\n          </p>\n          <div id=\"tag-list-container\"></div>\n          <button id=\"add-new-tag-btn\" class=\"btn-primary\">Neuen Tag hinzuf\u00fcgen</button>\n        </section>\n      </div>\n\n      <div id=\"analysis-results\" class=\"tab-content\">\n        <section class=\"analysis-results-section\">\n          <div class=\"results-header-actions\">\n            <h2>Letzte Analyseergebnisse</h2>\n            <button id=\"refresh-results-btn\" class=\"btn-secondary\">Aktualisieren</button>\n          </div>\n          <p class=\"help-text\">\n            Zeigt die letzten 20 analysierten E-Mails mit ihren Tags und Konfidenz-Werten.\n            Die Konfidenz zeigt, wie sicher die KI bei der Klassifizierung war.\n          </p>\n          <div id=\"analysis-results-container\"></div>\n        </section>\n      </div>\n\n      <div id=\"manual-review\" class=\"tab-content\">\n        <section class=\"manual-review-section\">\n          <div class=\"review-header-actions\">\n            <h2>Manuelle \u00dcberpr\u00fcfung</h2>\n            <button id=\"refresh-review-btn\" class=\"btn-secondary\">Aktualisieren</button>\n          </div>\n          <p class=\"help-text\">\n            \u00dcberpr\u00fcfen Sie E-Mails, die aufgrund von niedriger Konfidenz zur manuellen \u00dcberpr\u00fcfung markiert wurden.\n            Sie k\u00f6nnen Tags manuell anwenden oder entfernen.\n          </p>\n\n          <div class=\"review-filters\">\n            <div class=\"filter-group\">\n              <label for=\"review-sort-by\">Sortieren nach:</label>\n              <select id=\"review-sort-by\">\n                <option value=\"timestamp-desc\">Neueste zuerst</option>\n                <option value=\"timestamp-asc\">\u00c4lteste zuerst</option>\n                <option value=\"confidence-desc\">Niedrigste Konfidenz zuerst</option>\n                <option value=\"confidence-asc\">H\u00f6chste Konfidenz zuerst</option>\n              </select>\n            </div>\n            <div class=\"filter-group\">\n              <label for=\"review-filter-confidence\">Konfidenz-Filter:</label>\n              <select id=\"review-filter-confidence\">\n                <option value=\"all\">Alle anzeigen</option>\n                <option value=\"very-low\">Sehr niedrig (&lt;50%)</option>\n                <option value=\"low\">Niedrig (50-69%)</option>\n                <option value=\"medium\">Mittel (70-79%)</option>\n              </select>\n            </div>\n            <div class=\"filter-group\">\n              <label for=\"review-status-filter\">Status:</label>\n              <select id=\"review-status-filter\">\n                <option value=\"all\">Alle</option>\n                <option value=\"pending\">Ausstehend</option>\n                <option value=\"reviewed\">\u00dcberpr\u00fcft</option>\n              </select>\n            </div>\n          </div>\n\n          <div id=\"manual-review-container\"></div>\n        </section>\n      </div>\n    </div>\n\n    <div id=\"tag-modal\" class=\"modal\" style=\"display: none\">\n      <div class=\"modal-content\">\n        <span class=\"close-button\">&times;</span>\n        <h2 id=\"modal-title\">Neuen Tag hinzuf\u00fcgen</h2>\n        <form id=\"tag-form\">\n          <input type=\"hidden\" id=\"tag-index\" value=\"\" />\n          <div class=\"form-group\">\n            <label for=\"tag-name\">Tag-Name:</label>\n            <input type=\"text\" id=\"tag-name\" required />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-key\">Tag-Schl\u00fcssel:</label>\n            <input type=\"text\" id=\"tag-key\" required pattern=\"[a-z0-9_]+\" />\n            <p class=\"help-text\">\n              Eindeutiger Bezeichner (nur Kleinbuchstaben, Zahlen, Unterstriche).\n            </p>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-color\">Tag-Farbe:</label>\n            <input type=\"color\" id=\"tag-color\" value=\"#3498DB\" />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-prompt\">LLM-Prompt-Anweisung:</label>\n            <textarea id=\"tag-prompt\" rows=\"3\" required></textarea>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"tag-threshold\">Konfidenz-Schwellenwert \u00fcberschreiben (optional):</label>\n            <input\n              type=\"number\"\n              id=\"tag-threshold\"\n              min=\"0\"\n              max=\"100\"\n              placeholder=\"Globale Einstellung verwenden\"\n            />\n            <p class=\"help-text\">\n              Wenn angegeben, wird dieser Schwellenwert statt des globalen Werts verwendet.\n              G\u00fcltiger Bereich: 0-100%.\n            </p>\n          </div>\n          <div class=\"form-group\">\n            <button type=\"submit\" class=\"btn-primary\">Tag speichern</button>\n          </div>\n        </form>\n      </div>\n    </div>\n\n    <!-- Error Display Overlay -->\n    <div id=\"error-display-overlay\" class=\"error-display-overlay\" style=\"display: none\">\n      <div class=\"error-display-content\">\n        <div class=\"error-display-header\">\n          <span class=\"error-display-icon\">\u26a0\ufe0f</span>\n          <h3 id=\"error-display-title\">Fehler aufgetreten</h3>\n          <button class=\"error-display-close\" aria-label=\"Fehlermeldung schlie\u00dfen\">&times;</button>\n        </div>\n        <p id=\"error-display-message\"></p>\n        <div id=\"error-display-details\"></div>\n      </div>\n    </div>\n\n    <script src=\"options-bundle.js\"></script>\n  </body>\n</html>\n",
        "last_modified": "2026-01-06T15:39:51.887576"
      },
      "task_intent": {
        "title": "010-confidence-score-display-and-threshold-configurati",
        "description": "# Confidence Score Display and Threshold Configuration\n\nDisplay confidence scores for AI classifications and allow users to configure minimum confidence thresholds. Tags are only applied when confidence exceeds the threshold.\n\n## Rationale\nAddresses market gap-5: lack of transparency in AI decisions. Gmail and SaneBox don't explain why emails are categorized (pain-3-3). Users need to understand AI certainty and control when tags are applied to avoid incorrect classifications.\n\n## User Stories\n- As a cautious user, I want to see confidence scores so that I can understand how certain the AI is about its classifications\n- As a power user, I want to set minimum confidence thresholds so that only high-confidence tags are applied automatically\n\n## Acceptance Criteria\n- [ ] Confidence score (0-100%) is displayed alongside each tag suggestion\n- [ ] Global confidence threshold setting in options (default: 70%)\n- [ ] Per-tag confidence threshold override option\n- [ ] Low-confidence classifications are flagged for manual review\n- [ ] Confidence scores are stored with analysis history\n",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2025-12-28T18:38:44.216064",
  "last_updated": "2026-01-06T07:24:51.137944"
}